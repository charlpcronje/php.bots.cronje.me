<database 
    connection="heepp"
    name="modelHistory" 
    alias="Database Model History"
    single="ModelHistory">
    <table 
        name="model_history" 
        key="id">
        <columns>
            <query_type            alias="SQL Query Type"/>
            <model                 alias="DB Model Opened"/>
            <connection            alias="Database Connection Used"/>
            <table                 alias="Main Database Table Accessed"/>
            <columns               alias="Columns Selected From Main Database Table"/>

            <key                   alias="The Primary Key of the Database Table"/>
            <!--
            <CombKey               alias="The Combination Key that was used for the Main Database table"/>
            -->
            <got_results           alias="Were there any results found"/>
            <joins                 alias="Other Tables That Was Joined to The Main Database table"/>
            <found_double          alias="Were there any double records found during a Insert Query"/>
            <model_xml             alias="The Model's XML"/>
            <sql_query             alias="The SQL that was generated by the model"/>
            <log_query             alias="The Query that was responcible for writing to this History Log"/>
            <data_set_filter       alias="The filters that was set on the Dataset"/>
            <data_set_order        alias="The Ordering of the Dataset"/>
            <data_set_group        alias="How The Dataset was Grouped"/>
            <data_set_return       alias="In what format was the dataset results returned (array,json)"/>
            <data_set_limit        alias="The limit that was set by the dataset on the amount of rows that will be returned"/>
            <data_set_columns      alias="The Selected Columns in the Dataset"/>
            <data_set_concat       alias="The fields in the table that was concatinated (joined together)"/>
            <data_set_column_count alias="How many columns was selected by the dataset"/>
            <data_set              alias="The name of the Dataset that was used"/>
            <data_set_alias        alias="The User Friendly Name For The DataSet"/>
            <data_set_description  alias="Description of The DataSet"/>
            <order                 alias="Ordering that was set by the Model"/>
            <limit                 alias="The record count limit that was set by the Model"/>
            <group                 alias="The way the records are grouped by the model"/>
            <selected_rows         alias="How many rows was selected (By Select Queries)"/>
            <updated_rows          alias="The Actual Rows that was updated with the historical data"/>
            <deleted_rows          alias="The Actual Rows that was deleted with the historical data"/>
            <inserted_rows         alias="The Actual Rows that was inserted by the model with the data"/>
            <last_insert_id        alias="The Last Inserted Primary key into the target Main Database Table"/>
            <controller            alias="Which Controller Triggered this Model"/>
            <method                alias="Which Method Inside the Controller Triggered this Model"/>
            <params                alias="Other URL Parameters that was set"/>
            <user_id               alias="The User Responcible for triggering this Model"/>
            <dtime                 alias="The Date and Time this Model was Triggered"/>
        </columns>
    </table>
    <join 
        table="users" 
        type="inner" 
        left="model_history.user_id" 
        right="users.id">
        <columns>
            <first_name
                as="user_name_surname" 
                concat=" " 
                alias="User Name"/>
            <last_name
                as="user_name_surname" 
                alias="User Surname"/>
        </columns>
    </join>
</database>
<datasets> 
    <all 
        alias="Select all model history" 
        description="Select all model history and order by `dtime` DESC">
        <order>
            <dtime order="DESC"/>
        </order>
    </all>

    <byId 
        alias="Select model history by id" 
        description="Select model history where `id` = ${id}">
        <filter>
            <id equal="${id}"/>
        </filter>
    </byId>

    <byUserId 
        alias="Select model history by user id" 
        description="select model history where `user_id` = ${userId} and limit ${start},50 and order by `dtime` DESC">
        <filter>
            <user_id equal="${userId}"/>
        </filter>
        <limit start="${start}" rows="50"/>
        <order>
            <dtime order="DESC"/>
        </order>
    </byUserId>
</datasets>